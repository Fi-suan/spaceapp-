# –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

## üì¶ –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 5 –≥–æ—Ä–æ–¥–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫–∞–∂–¥—ã–µ 20 –º–∏–Ω—É—Ç.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –∫—ç—à–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ **–ú–µ–Ω—å—à–µ API –≤—ã–∑–æ–≤–æ–≤**: –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑ –≤ 20 –º–∏–Ω—É—Ç
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
- ‚úÖ **–§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–æ–Ω–µ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

## üèôÔ∏è –ì–æ—Ä–æ–¥–∞ –≤ –∫—ç—à–µ

1. **–ê–ª–º–∞—Ç—ã** (almaty) - 43.2220, 76.8512
2. **–ê—Å—Ç–∞–Ω–∞** (astana) - 51.1694, 71.4491
3. **–ü–∞–≤–ª–æ–¥–∞—Ä** (pavlodar) - 52.2873, 76.9665
4. **–ï–∫–∏–±–∞—Å—Ç—É–∑** (ekibastuz) - 51.7244, 75.3232
5. **–ê–∫—Ç–∞—É** (aktau) - 43.6506, 51.1603

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞:
1. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö 5 –≥–æ—Ä–æ–¥–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
2. –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ö–∞–∂–¥—ã–µ 20 –º–∏–Ω—É—Ç:
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
2. –°—Ç–∞—Ä—ã–π –∫—ç—à –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üì° API Endpoints

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
```bash
GET /cities
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "cities": [
    {
      "id": "almaty",
      "name": "–ê–ª–º–∞—Ç—ã",
      "latitude": 43.2220,
      "longitude": 76.8512
    },
    ...
  ],
  "total": 5
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫—ç—à–∞
```bash
GET /cache/stats
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "cached_cities": ["almaty", "astana", "pavlodar", "ekibastuz", "aktau"],
  "total_cities": 5,
  "last_updates": {
    "almaty": "2025-10-05T12:00:00",
    "astana": "2025-10-05T12:00:00",
    ...
  },
  "update_interval_minutes": 20
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö

–í—Å–µ dashboard —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `city_id`:

#### 1. Agriculture Dashboard
```bash
# –° –∫—ç—à–µ–º (–±—ã—Å—Ç—Ä–æ) ‚úÖ
GET /api/v1/dashboard/agriculture?city_id=almaty

# –ë–µ–∑ –∫—ç—à–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ, –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API)
GET /api/v1/dashboard/agriculture?latitude=43.2220&longitude=76.8512
```

#### 2. Insurance Dashboard
```bash
# –° –∫—ç—à–µ–º (–±—ã—Å—Ç—Ä–æ) ‚úÖ
GET /api/v1/dashboard/insurance?city_id=astana

# –ë–µ–∑ –∫—ç—à–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ)
GET /api/v1/dashboard/insurance?latitude=51.1694&longitude=71.4491
```

#### 3. Wildfires Dashboard
```bash
# –° –∫—ç—à–µ–º (–±—ã—Å—Ç—Ä–æ) ‚úÖ
GET /api/v1/dashboard/wildfires?city_id=pavlodar

# –ë–µ–∑ –∫—ç—à–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ)
GET /api/v1/dashboard/wildfires?latitude=52.2873&longitude=76.9665
```

#### 4. Main Dashboard
```bash
# –° –∫—ç—à–µ–º (–±—ã—Å—Ç—Ä–æ) ‚úÖ
GET /api/v1/dashboard/main?city_id=ekibastuz

# –ë–µ–∑ –∫—ç—à–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ)
GET /api/v1/dashboard/main?latitude=51.7244&longitude=75.3232
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:
```typescript
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ city_id –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
const fetchDashboardData = async (cityId: string) => {
  const response = await fetch(
    `/api/v1/dashboard/agriculture?city_id=${cityId}`
  )
  return response.json()
}

// –ü—Ä–∏–º–µ—Ä
fetchDashboardData('almaty') // ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫—ç—à–∞
```

### –ë–µ–∑ city_id:
```typescript
// –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API (–º–µ–¥–ª–µ–Ω–Ω–æ)
const response = await fetch(
  `/api/v1/dashboard/agriculture?latitude=43.22&longitude=76.85`
)
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –î–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å: 3-5 API –≤—ã–∑–æ–≤–æ–≤
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 2-5 —Å–µ–∫—É–Ω–¥
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API: –≤—ã—Å–æ–∫–∞—è

### –ü–æ—Å–ª–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å: 0 API –≤—ã–∑–æ–≤–æ–≤ (–∏–∑ –∫—ç—à–∞)
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: **< 50ms** ‚ö°
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ 20 –º–∏–Ω—É—Ç
- –≠–∫–æ–Ω–æ–º–∏—è API –≤—ã–∑–æ–≤–æ–≤: **~99%**

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—ç—à–∞:
```python
{
  "city_id": "almaty",
  "city_name": "–ê–ª–º–∞—Ç—ã",
  "latitude": 43.2220,
  "longitude": 76.8512,
  "climate": {...},      # NASA POWER data
  "weather": {...},      # OpenWeatherMap data
  "air_quality": {...},  # AQI data
  "fires": {...},        # FIRMS fire data
  "cached_at": "2025-10-05T12:00:00",
  "expires_at": "2025-10-05T12:20:00"
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üöÄ Starting SpaceApp API...
üì¶ Initializing cache for cities...
‚úì Loaded data for –ê–ª–º–∞—Ç—ã
‚úì Loaded data for –ê—Å—Ç–∞–Ω–∞
‚úì Loaded data for –ü–∞–≤–ª–æ–¥–∞—Ä
‚úì Loaded data for –ï–∫–∏–±–∞—Å—Ç—É–∑
‚úì Loaded data for –ê–∫—Ç–∞—É
‚úÖ Cache initialized and background refresh started
```

–ö–∞–∂–¥—ã–µ 20 –º–∏–Ω—É—Ç:
```
Refreshing all 5 cities...
‚úì Refreshed data for –ê–ª–º–∞—Ç—ã
‚úì Refreshed data for –ê—Å—Ç–∞–Ω–∞
...
All cities refreshed
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
–í `back/app/services/cache_manager.py`:
```python
self._update_interval = timedelta(minutes=20)  # –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –≥–æ—Ä–æ–¥–∞:
–í `back/app.py`:
```python
CITIES = [
    {
        'id': 'new_city',
        'name': '–ù–æ–≤—ã–π –≥–æ—Ä–æ–¥',
        'latitude': 00.0000,
        'longitude': 00.0000
    },
    ...
]
```

## üö¶ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫—ç—à–∞:
```bash
curl http://localhost:8001/cache/stats
```

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:
```bash
curl http://localhost:8001/cities
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-20 —Å–µ–∫—É–Ω–¥
2. **–ü–∞–º—è—Ç—å**: –ö—ç—à —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ RAM, –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ
3. **Fallback**: –ï—Å–ª–∏ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫—ç—à–µ, API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ

## üéâ –ò—Ç–æ–≥–æ

–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚ö° **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: < 50ms –≤–º–µ—Å—Ç–æ 2-5 —Å–µ–∫—É–Ω–¥
- üí∞ **–≠–∫–æ–Ω–æ–º–∏—è**: ~99% –º–µ–Ω—å—à–µ API –≤—ã–∑–æ–≤–æ–≤
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- üìä **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –≥–æ—Ä–æ–¥–∞
